{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(loadBox3),\n    _marked2 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(loadSpace),\n    _marked3 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(_callee);\n\nimport { call, put, takeLatest, select } from 'redux-saga/effects';\nexport var LOAD_BOX3 = 'LOAD_BOX3';\nexport var WEB3_LOADING = 'WEB3_LOADING';\nexport var LOAD_BOX3_PENDING = 'LOAD_BOX3_PENDING';\nexport var LOAD_BOX3_COMPLETE = 'LOAD_BOX3_COMPLETE';\nimport Box from '3box';\nexport function loadBox3() {\n  var addresses, myAddress, box, myProfile;\n  return _regeneratorRuntime.wrap(function loadBox3$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return put({\n            type: WEB3_LOADING\n          });\n\n        case 2:\n          _context.next = 4;\n          return call(window.ethereum.enable);\n\n        case 4:\n          addresses = _context.sent;\n          myAddress = addresses[0];\n          _context.next = 8;\n          return put({\n            type: LOAD_BOX3_PENDING\n          });\n\n        case 8:\n          _context.next = 10;\n          return call(Box.openBox, myAddress, window.ethereum, {});\n\n        case 10:\n          box = _context.sent;\n          _context.next = 13;\n          return call(Box.getProfile, myAddress);\n\n        case 13:\n          myProfile = _context.sent;\n          _context.next = 16;\n          return call(new _Promise(function (resolve, reject) {\n            return box.onSyncDone(resolve);\n          }));\n\n        case 16:\n          _context.next = 18;\n          return put({\n            type: LOAD_BOX3_COMPLETE,\n            payload: {\n              box: box,\n              myProfile: myProfile,\n              myAddress: myAddress,\n              loggedIn: true // box, myProfile, myAddress\n\n            }\n          });\n\n        case 18:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\nexport function loadSpace() {\n  return _regeneratorRuntime.wrap(function loadSpace$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          Box.getSpace(address, name, opts);\n\n        case 1:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2);\n}\nexport default function _callee() {\n  return _regeneratorRuntime.wrap(function _callee$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.next = 2;\n          return takeLatest(LOAD_BOX3, loadBox3);\n\n        case 2:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3);\n}","map":{"version":3,"sources":["/Users/liamz/Documents/open-source/everest/social/sagas/index.js"],"names":["loadBox3","loadSpace","call","put","takeLatest","select","LOAD_BOX3","WEB3_LOADING","LOAD_BOX3_PENDING","LOAD_BOX3_COMPLETE","Box","type","window","ethereum","enable","addresses","myAddress","openBox","box","getProfile","myProfile","resolve","reject","onSyncDone","payload","loggedIn","getSpace","address","name","opts"],"mappings":";;;;;yBASiBA,Q;;;yBAsCAC,S;;;;;AA/CjB,SAASC,IAAT,EAAeC,GAAf,EAAoBC,UAApB,EAAgCC,MAAhC,QAA8C,oBAA9C;AAEA,OAAO,IAAMC,SAAS,GAAG,WAAlB;AACP,OAAO,IAAMC,YAAY,GAAG,cAArB;AACP,OAAO,IAAMC,iBAAiB,GAAG,mBAA1B;AACP,OAAO,IAAMC,kBAAkB,GAAG,oBAA3B;AAEP,OAAOC,GAAP,MAAgB,MAAhB;AAEA,OAAO,SAAUV,QAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACH,iBAAMG,GAAG,CAAC;AACNQ,YAAAA,IAAI,EAAEJ;AADA,WAAD,CAAT;;AADG;AAAA;AAIe,iBAAML,IAAI,CAACU,MAAM,CAACC,QAAP,CAAgBC,MAAjB,CAAV;;AAJf;AAIGC,UAAAA,SAJH;AAKGC,UAAAA,SALH,GAKeD,SAAS,CAAC,CAAD,CALxB;AAAA;AAOH,iBAAMZ,GAAG,CAAC;AACNQ,YAAAA,IAAI,EAAEH;AADA,WAAD,CAAT;;AAPG;AAAA;AAWS,iBAAMN,IAAI,CAACQ,GAAG,CAACO,OAAL,EAAcD,SAAd,EAAyBJ,MAAM,CAACC,QAAhC,EAA0C,EAA1C,CAAV;;AAXT;AAWGK,UAAAA,GAXH;AAAA;AAYe,iBAAMhB,IAAI,CAACQ,GAAG,CAACS,UAAL,EAAiBH,SAAjB,CAAV;;AAZf;AAYGI,UAAAA,SAZH;AAAA;AAeH,iBAAMlB,IAAI,CAAC,aAAY,UAACmB,OAAD,EAAUC,MAAV;AAAA,mBAAqBJ,GAAG,CAACK,UAAJ,CAAeF,OAAf,CAArB;AAAA,WAAZ,CAAD,CAAV;;AAfG;AAAA;AA0BH,iBAAMlB,GAAG,CAAC;AACNQ,YAAAA,IAAI,EAAEF,kBADA;AAENe,YAAAA,OAAO,EAAE;AACLN,cAAAA,GAAG,EAAHA,GADK;AAELE,cAAAA,SAAS,EAATA,SAFK;AAGLJ,cAAAA,SAAS,EAATA,SAHK;AAILS,cAAAA,QAAQ,EAAE,IAJL,CAKL;;AALK;AAFH,WAAD,CAAT;;AA1BG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsCP,OAAO,SAAUxB,SAAV;AAAA;AAAA;AAAA;AAAA;AACHS,UAAAA,GAAG,CAACgB,QAAJ,CAAaC,OAAb,EAAsBC,IAAtB,EAA4BC,IAA5B;;AADG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKP,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AACX,iBAAMzB,UAAU,CAACE,SAAD,EAAYN,QAAZ,CAAhB;;AADW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA","sourcesContent":["import { call, put, takeLatest, select } from 'redux-saga/effects'\n\nexport const LOAD_BOX3 = 'LOAD_BOX3'\nexport const WEB3_LOADING = 'WEB3_LOADING'\nexport const LOAD_BOX3_PENDING = 'LOAD_BOX3_PENDING'\nexport const LOAD_BOX3_COMPLETE = 'LOAD_BOX3_COMPLETE'\n\nimport Box from '3box';\n\nexport function* loadBox3() {\n    yield put({\n        type: WEB3_LOADING\n    })\n    const addresses = yield call(window.ethereum.enable)\n    const myAddress = addresses[0];\n    \n    yield put({\n        type: LOAD_BOX3_PENDING\n    })\n    // // get my box and profile\n    const box = yield call(Box.openBox, myAddress, window.ethereum, {})\n    const myProfile = yield call(Box.getProfile, myAddress)\n\n\n    yield call(new Promise((resolve, reject) => box.onSyncDone(resolve)))\n\n    // open 3chat space\n    // const chatSpace = await box.openSpace('3chat');\n    // const myDid = chatSpace.DID;\n\n    // // set all to state and continue\n    // const loggedIn = true\n    // this.setState({ chatSpace, box, myProfile, myAddress, myDid, loggedIn });\n\n\n    yield put({\n        type: LOAD_BOX3_COMPLETE,\n        payload: {\n            box,\n            myProfile,\n            myAddress,\n            loggedIn: true\n            // box, myProfile, myAddress\n        }\n    })\n}\n\nexport function* loadSpace() {\n    Box.getSpace(address, name, opts)\n}\n\n\nexport default function* () {\n    yield takeLatest(LOAD_BOX3, loadBox3)\n}\n"]},"metadata":{},"sourceType":"module"}